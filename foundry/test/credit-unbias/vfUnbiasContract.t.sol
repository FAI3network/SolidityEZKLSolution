// SPDX-License-Identifier: MIT
pragma solidity ^0.8.13;

import {Test, console} from "lib/forge-std/src/Test.sol";
import {Halo2Verifier} from "../../src/credit-unbias/VerifierCreditUnbias.sol";
import {Utils} from "../../utils/utils.sol";

contract VfUnbiasContractTest is Test {
    Halo2Verifier public vf;
    Utils public utils;

    /* Constants */
    string constant I_PROOF =
        "0x09bc59733a87c38c6b97ea68f96fa44d065623a8c72e950609531e9cb3cfc1c712de49d4c73086e2833f091f8801803cdb8c51cdfe6809b323576bbab070ea382ae73cde542fbb1ebce511d1d5183a5456c0aa1fc903dae88a932928e94ce3c51d56f31ec210027e33fd8374f7719fb67875a5c97477097e72e54b5c2853f2b72411e5a472aefbb42d94f583f1d616acf2dd15e12608feee18960e550dfc6df60cdeeb8eeb3ff8b0db8cf034b62314abb545f1090e1ff9a7cc786fb4bd3e2568098a4f757e47f194c52b9403a8aeb515fd7fcd84c2467a4eba25ca22d270a3ee04f379692036e2395c8b872138e6572060ae18f150366314800c267b7d0a8c81258537a9bccf7dac0b3eb279cffcf67a004db665634bb509aae03092606b4aad21bc006fc06852f085d169eb208bb9dd86a9310c20e6c5d98dd1be223995f33e23f21de5759d4a7f5fa1723ae7a02fc3f04b03d76889adbcd60e7a8280075ab10b97138d43d8b966823165d799abc599c575a50466a45c66d90aa16df02181b61874773102c7343f11ad2daaa968e0142cd3f028add85b4207e8af2c33c7598f0e6be1c26081811be4aae52bc798dcd9f720018e3e8f04aa778fb9192359c7710008f3e99b88b97518a41c285fab72f095b91c5751fb3b8f097a7b069f70b4da29c1aad3da41d714ecffdb583becc9766211fa9bfdaae923a4edf84d9316741726ecb3c1d543e0b64c48ff0b5a1fd5aef6c05056d16c5a8e054b82953bb9588a22aa7c1a5a0cc1f7987c4340f3437db2c6a57bdca293776a0b340913984f4b420c6fc7a95bbfeafdc967835944ddce2cce6d48df109ff01276a426b832a3654c1a306ba91f68f4d140c03c9c4e6005d3e5c1902a1ef136ea3688f8aec81628f502da982d165ab4694a9af93a00c0d094b6746f0efbee19c1222a44db3218837b02c1b210ecf8efe9ef3683383df8f3a75b0c8934cc589cb58fd013cacf6fd77717fd82b7116a825aee3e06b413f423b703df3e06b5ee140b0ab557bd56aa6a550a9561e7b22acec0dea60130573bf9761e0d22920527fe2bfa87c6a651929b0f119252703c56d3ea4aea351c0e385494b4f86cb59f21d68b74819c85c56a64872b813f0fb19938a1b2a1a7a5af4632aa8faee1f77d53282c9a895cc6cceaf28e2dc45b1140d1b5bafc9cf86b39bb8e068bde808b75a1debe6b7103f992b557e40b342e082d5051f7bd63b66b8c1e6ced79f9ed0639dbe3139d667b6b6955b04f00577c5dc7510b687fd03b40c8718ca1b8a1330daa170d56349c5a79de6d10f90593096b71407e34ff579ee7b86792ea873f58f24933247328a34c3e0d1f911801193acb101daa40ad7d51192a52f015392e8298ffd38c89ee50f2fb34b567e41ad562620d0d95ccbcaf088f0185b5371d46fca7eb645cc68933660435e9bf680b203d2a38138884f00f65d6856a7d4402b5936cd662c0fcccdd054cf71c034a19c8bf43ae052d8cba7c4efcd787f0094937ea222b18e0377a878efbf5f279f900577c5dc7510b687fd03b40c8718ca1b8a1330daa170d56349c5a79de6d10f90593096b71407e34ff579ee7b86792ea873f58f24933247328a34c3e0d1f91180c3c99c2e0182e79533879988a1f71be2e2ac3f172e221603188fb8289e0f96c206d3a8ad3b202c4efff75e7fdb9e7d8c7f2e75f5467e30f81bc3201c246ad652b3c9702c52fd82435264dd845b43fc14b3e05a459ba3e1d5881a4889a770cb90f2508c19aaaab63459da9929facab9ed1e9dd2c66d023d238bc7172c7a110570eb1b83ffee96546dc16883619f06d1be29eab123c71c37086a68b6d146b5b3f0eccf84ef054aee2b3a1ba654e01bbc95da3fe061b8916f56f72500b1f7b0dcb076b72471206206069a568cd7d8c05adc070460c24e0d0586b072b680eaaf93b04bdfca19d77fa4b0c76e8438ff4739c133ad00e9fc9693c6eb48637c5f90ae910fc32fb0867a35d71c37a90530e7be807a061b1bc5ea170e29d6e50b51f9f4d29b82542963c5cdb4ab9bf5fa9250217244806452d74347df0b97c4003344ca11881b9b35a819cf2bfb9b2d71a763158b20dad3289d441db2945ad9bff1be4ee20a47d911964e38d6db7d107b53e7e6c5c57784d86230df5e9427041851ebfee1eacc3ce953c266c97e45bf7a531b7331efc1515aed17616a72719b1be46adcd11c952e0a6a21f71e70084564ac9a0e903aa78322a91654d15207e57449a8a7f055e8e1a9da0ae3462d21f6063296d726663a5b4c03e8acf0388d699234cffb02cf822998a9037e4c3066aa010bac3719f646ac3d80cef146cc37f7893d38ccd172f8571882175c5fc64432fac968bffaf08ebac36717df61ccb54560c10a0881f2583a53d46b9462e7ae52ba4ee84dd1d9d1e6788b25b7796d2e4471f1152da12504c11cb2ca7c8c045be2385990f85565a51b9da53e5a356221fe3ed134e880ce6593f0c278cbfc4a61db8a68517deb2f57eee78a94ec94f423a8654909ceb2a935f622d6e248308c373d9661bc649dd7968641ca4163dc9c16637d8f70ee7211e75c97e9d77ffb24f8177a3b4757d2ff16c183939e5027d998bd5b8785ea122d231016a90b9f490066be1e2b9d755dd4f9aef47734705fd164344460f98222a591f35328e014e36735c9204981122b29aeb57e63a4fd59ae344b7ff85270e25e799b0a65e24b481871f154048173e7ba6e83e60f10f385588b4f4fd6a0459101c74f370439bae1ec237e81a2d7f8cc1e5418927a1468188785342177b8ccb0666f72f3d07d26ffbd7ff7ad65ea8e2caa515eb8c350e45360ae42a89ca7f452a8ab1ffdd799d39f7f5adacea5233cd0d8c7602ca25c5022a5e5db1911b10321b9313701a7f8fbe788e82d1b94a7614d6a2bebb4684a88ebf18298c1d652bb40cc7582fc1955e1713a3be587ac4d7b14e909d9391a262daa6f5447f234f845214981a2bb027077b8b8273bd580a053f29504268e4558f54bac7c6273d771e88276add68f6d31916733848149a69b83a09e8fbd5af97a1d983c8a5701fd5e55329f39e9522c15a17a6dc1a516723ac19de9c59dbda28e04ac32f2be3b410a7d400c9b5bbeb49861e2c29d44a2f61fb8007392e03bd38f3ac0beca5858984a19315424d4bf6358570fa2c4a40d3fa713c166675db3f464130f1ac402dc5bd81d4002e1e9666c90ad24d40e721a9ca726c5a34e474e15355cdeaee0c7f97448cce2d4e24dfc5fa40d6154c3d003bd74a237b22a487bcc6e2d642c269f2c689fbe321d300b6693f648cf6469242a6f83657ef054d8aae418091733b663ce84cbce71759e86f9059bbe7f0b528eb3178b08380e1b512f418b3d38e00404e2c3c644c11bcf56f6e1a76b18982ca21a45a3dcda7e3abf177c6e5b573997298f9df044c04d221c058b50a57c570e6b882af510228701f1d611bec0690fb0b5739e3a7a20d2144ee106a837e2c98d4bb96bd1d0571d46266e50376a8355e42e4d67042182760e973466eac3c251e6882d25a32a5c05030c8930b32d7aa0f9339957a356300fa6ba675664476cbd7746d97ff6bef82cc29214f3f762587080f6497430c2420c1bf944b7dcf86951ad33bdb04605a4eb62a12a55a4540dc496adceceffbd11ff36b7403e468418ef507b31891464890a465c86901cafc0c3de3add005a2dd2a0364c9d0a768cfb6626c51f9f1d53b2756a7d2a2acab240f856d89b475f86b05e4897fa9b380da9b63112940897a3b1218e4ab7877612fd1a93ab8f7fc7f27036d08996db669e40aec50821dcfe16fa944e3363a6517937ee7cea545aaec362eb625767b5da6b0bf8b2992638bec8a649f56bdd9bc35bc807bac48ccb3edf4232a206352dc9803af9007441d4d51bcd435ac8d33a9bbc2ab0924314d426a0719037d0d542ccacda4f9aaaffc8acfc0c486ab906cb147ea5906a84ddd5eb9872b24c68d8f9ea52822730ad4eaf1f0cff6b9e6f24865478510d044c1d0d9606b14907fe46c6516a10a190b95b732fb300013f84f713d59d0d32176e810626caa2821c9800e6963f98714abeaff0edddf965c9bc08e9b65cdfbe29a07961509c5283cc04983ff7ee08a6a1872a4470feae56aad1b6bedd925aa7268ac7da17dc4000000000000000000000000000000000000000000000000000000000000000007282168c908a34f620b75cc04a04472c33a24124cbfca2f492a978c633db6ea176ab67fa967c52d8f25dd1e23d43ad2d144ffccb50844e3490ea1b489f4af2700000000000000000000000000000000000000000000000000000000000000000814ba76744d026ce569d3bd1140b47406e5187529d451cbe0aa1a37fb140cc61fdd7006abd26a7427bea8efb1da89aa0ce6547eaf6b953674e03bdf756a7967172dd791775256cc38df05f7b3b929a9d00a5c3304224668af7c2af4d4dcbcd318abffd3f21de5a234f24bddd3e3b375544c277d2fdbe600ff650700f65c79e9014bf3a6099cebd4157bbfc7f5eae45b0010084df4206bab1f35de532f67b8952555ad738e3f129411c7d37b62810539e6431a59b607c804d239f214e0b8e9d81c612cdbeddea7eb6b156618ba72c909f57d15698f18debd7ea6ab7f762f85c30a1fbe22306081ff07e24307d3ce456c24093f5ac141d16055475b25aa74ae9f1e72662cf9692b13db49ac6cff4981f6b3949a5c7e9c33c020ec0aa04c9bf3db00000000000000000000000000000000000000000000000000000000000000000f540709547fa4e7a5f46613bc88232de2288c493091035d18aaf5fa4f439bb5008f21781230101edd40ac1d0324964d81e8cd4203e12290e0a77910e85628d5299b5b973b507ecc1b31a2c13e28262a1f370a2ba09dce1d4c72431911f10a2f2a79e5ba04cad38c8af720dd7ff9c46083a348955c9fe107b88b04097313c5d3023377fe139e5d979a421e7b46768457a0b4eb554f1af59e032fc12d4dde03ee2d0663d4033265534656bf7021fec7cafafb21ad6badb7015fe7a877699bb36304074155e8a5d21ae605c2b4c4286f19480ff26cad3420e276fbad3a527dc69a0509e213b3aa4c3ce8f65f68de59319ade802ba7a3f6a28ca44ad23c821558ed0179cb8d8bfe4759d1f7f6a638e1a581e517f0f3714862aa53ecdf64ed7e878c1f894819d77081b612407716fc8c1b5fa43589f6608c26f5e1c6a866508e5f592a218e9d2bbb8459c8443476cddf161eecbdad7827b37fb10ca35a6d59fb0a9a2c6e3e61e1af000997aa632496be41c914d2ad5ab22fd9ba43585b33c5d64ad40553688a1d381ad63691d2d797cc317d4361de1214be581b3049e1444cae55dc170efea3a0dd8202111999ea662089580a01ff8305b5df90151df26a87fb47321b8fa45919a56886647e913dcd4255c61e6431adaa2f452f5ea5a8bd6239a4512f08ace153da8a2377b9f65d7247015e03fd1810e3271708e5e80cc0f4e4b30527a05736dbc3f65f4630415a76e43506baabbfc39b1ddc493d4d0076c374d65013778502cff480e91400d0519b83d9d52b3efa68f8a00dba054ac9fe06f556b721df6f261eae15929cd2c8ee9d9d5699778b3362b744dc8155358021b4379c68264f11ff8db32adf1e61c5aa55200bcbeb57828ac9e2e1d25712af50ffd4853f2227e7ced7cc507037fd963e3cb5d5ae843780ae0bf797edf7695c786e9af5a91a2b9d091bbf82eef0b900caca2f88ac561a0421327bb420a33c366efce5218510d3bcae0f0667b6ffab55f38471ccb3d9411f2a63e1bf78e73ed6d23cdaad860d975be1d36bbe10e8b0d50a4e6d35e9567599b986307754dea454fd92d65aed2b7c98487d366d25ce3cb471c9a1164f20e520a21a18eec8722074754c59bdf91aac230477d7fa0ebbda425875c98a4e5a7e40d625d40f3ea666c2888009beb822796839c2977a19e1ec80a79d3a3e9ea1dcb44f77358ca4761908c7821a2ce302e16ff23fa631ae9e23b5b5c3c71578ba38a9a29e3794219923b5cd7d1f71251b682548ac835235fb7eb1be394c19a94766c82ffde9ec6d2e63493c9a49ac5500ea090c5df3299b14384a4a09ebf14a71515e8e4db57807029db604554e36ac2d68b93dec8f59e6bec9c4b7742f49fc44f3f3955ad4d9a63111ddb3b22ec3a10397dbe85d5efbfd54bd827cfde59f1eba2120e584ad9ce07cd084971843f7292e16073e2811f3beaa120acac7f6405b28d58a959079b2cb97d5af988c733c3420e257896675047ee741d100f3cbaba34069d96647212cb8e9da167202a7c4781f969baea5d220de8616b1d2f6f37e010ffcf70404569dd010a07eba4be3c62a177451e5299d50e8f6ad1d4a04d8e62b39e58a1889b8275c06fe33665ab294be27ce2b749c3553fbe95b5e2b51a9db8ae59b8a47afdf81595b5085c5dd7c485b1a519ef885dfdcdf6983935f831b0ab6b726557f58bdcefde76592fff72bfd2f1b0191caf735ed7b3c8bc8ef6cb38237dae500beb2a3ca1146ef0d5171e769b326093d9a8c265fd610f05621e1df87af39361d74e772be6d5c24e51c8faafe002291a195703954989cacc41b52b5b1680449c25ece544f17449d21e8e48de49122de0f7ce206e8628cb0991d7ec9365dd57cf81cd77a60122db6a496b899357e0144c5cd8fb38f2bd9a0355b2d8a6f1fed35be901e5e7e9fca59292ab45068a4037f5bcdc68e25057e4231655a7aa23859565f8db6231462c9e7c7667b56b4882fba6bd41ededb6e4846f172c2f262592e928ea6bca0490f5221f2ea41f240ac2f06335e6ebe684a449a83d910a7f23f79cf0c0a9002d674517ed97332aff7e107251d38a3376f167e08e817360c6099d6502a4b91ae2dcc58b56c18aadff53d1b0191caf735ed7b3c8bc8ef6cb38237dae500beb2a3ca1146ef0d5171e769b3064e2a2efe0576a26ba0638b816e7928423f5334fd76490bcca2ed440831df1d2deb0e457e1d563f41478a473478e9288d2f1e7894289f49a498cc286fda0214219b21f88895584549382da5cac941ac4bd37f1abe3bef90b2865b4ac85a0a14186a70badb141dfde985493a0b02bed2abfd052d8e48f046ecd4e2af4bb6d5a318b4171121a84790bf0c4b6690d5a462537a66620b31ca5250d27bbb5cfe527e2d834de6650ddcb7c5d2a009f2db8b63dfa786caf592e5f8b8ce7c2f2612638f12bb264e44144d89edd7bea8816d1b896062de35b790c0b86d74952cf6ea8846";
    string[] public I_INST;

    function setUp() public {
        vf = new Halo2Verifier();
        utils = new Utils();
        I_INST = [
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x0000000000000000000000000000000000000000000000000000000000000b25",
            "0x00000000000000000000000000000000000000000000000000000000000004db"
        ];
    }

    function test_Proof() public {
        bytes memory proof;
        uint256[] memory instances;
        (proof, instances) = utils.setParams(I_PROOF, I_INST);
        bool result = vf.verifyProof(proof, instances);
        assertTrue(result);
    }
}
